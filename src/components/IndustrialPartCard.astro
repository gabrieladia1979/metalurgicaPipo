---
// Component: IndustrialPartCard.astro
interface Props {
  partNumber: string;
  name: string;
  specs: Record<string, string>;
  image?: string;
  inStock?: boolean;
  pdf?: string;
}

const { partNumber, name, specs, image, inStock = false, pdf } = Astro.props;
import site from '../data/site.json';
const whatsappNumber = site.whatsappNumber || '5491100000000';
const whatsappMessage = `Hola, consulto por el repuesto c√≥digo ${partNumber}: ${name}`;
const specsText = Object.values(specs).join(' ');

const currentPath = Astro.url.pathname;
const isEnglish = currentPath.startsWith('/en');
const txt = {
  instock: isEnglish ? 'In Stock' : 'En Stock',
  consultar: isEnglish ? 'Inquire' : 'Consultar',
  parts: isEnglish ? 'Spare Parts' : 'Repuestos'
};
---

<div class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 flex flex-col h-full group" data-title={name} data-category={txt.parts} data-description={`${partNumber} ${name} ${specsText}`}>
  <div class="bg-gray-50 px-4 py-3 border-b border-gray-100 flex justify-between items-center bg-opacity-50">
    <span class="text-xs font-mono font-bold text-gray-500 tracking-wider">COD: {partNumber}</span>
    <span class={`text-[10px] uppercase tracking-wider font-bold px-2 py-1 rounded-full ${inStock? 'text-emerald-700 bg-emerald-50 border border-emerald-100' : 'text-gray-500 bg-gray-100 border border-gray-200'}`}>
      {inStock ? txt.instock : txt.consultar
      }
    </span>
  </div>

  <div class="relative h-64 overflow-hidden bg-white flex items-center justify-center p-6">
    {image ? (
      <img 
        src={image} 
        alt={name} 
        class="w-full h-full object-contain transition-transform duration-500 group-hover:scale-110" 
      />
    ) : (
      <div class="flex items-center justify-center text-gray-200 group-hover:text-gray-300 transition-colors">
        <svg class="w-24 h-24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
      </div>
    )}
  </div>

  <div class="p-5 flex flex-col flex-grow relative">
    <h3 class="text-lg font-bold text-gray-900 mb-2 leading-tight">{name}</h3>

    <div class="text-sm text-gray-700 mb-4 bg-gray-50 p-3 rounded border border-gray-100">
      <table class="w-full text-sm">
        <tbody>
          {Object.entries(specs).map(([key, value]) => (
            <tr key={key} class="align-top">
              <td class="font-semibold py-1 pr-3 text-gray-500 w-36">{key}</td>
              <td class="py-1 text-gray-900">{value}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>

    <div class="mt-auto grid grid-cols-2 gap-3">
      {pdf ? (
        <a href={pdf} target="_blank" rel="noopener noreferrer" class="flex items-center justify-center gap-2 border border-gray-300 text-gray-700 py-2 rounded hover:bg-gray-50 text-sm">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 2v10l3-3 5 5v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h6z"></path></svg>
          Ficha PDF
        </a>
      ) : (
        <button class="flex items-center justify-center gap-2 border border-gray-300 text-gray-700 py-2 rounded text-sm" disabled>
          No disponible
        </button>
      )}

      <a href={`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`} target="_blank" rel="noopener noreferrer" class="flex items-center justify-center gap-2 bg-bergner-red text-white py-2 rounded hover:opacity-95 text-sm">
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.67-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.076 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347"/></svg>
        Cotizar
      </a>
    </div>
  </div>
</div>
